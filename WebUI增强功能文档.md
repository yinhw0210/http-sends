# HTTP模拟请求与IP伪装功能文档

## 功能概述

根据用户需求，我们已经为HTTP模拟请求工具的Web界面添加了全面的代理配置和IP伪装功能，使所有高级功能都可以通过WebUI进行配置和使用。这些增强功能使得工具在网络请求模拟和性能测试场景下更加灵活和强大。

## 主要功能增强

### 1. 界面分区优化

我们重新设计了界面结构，使用标签页将配置选项分为三个主要区域：

- **基本配置**：包含URL、请求方法、请求头、数据等基本参数设置
- **IP伪装**：包含代理服务器配置、User-Agent轮换和IP地址伪装设置
- **高级设置**：包含异步模式选择、并发控制、速率限制等性能参数

这种分区方式保持了界面的整洁性，同时提供了对所有高级功能的完整访问。

### 2. 代理服务器支持

添加了完整的代理服务器配置功能：

- **代理模式选择**：
  - 单个代理：直接输入代理服务器地址
  - 代理池模式：上传包含多个代理的文件

- **代理类型支持**：
  - HTTP
  - HTTPS
  - SOCKS4
  - SOCKS5

- **代理文件上传**：
  - 支持上传包含多个代理服务器地址的文本文件
  - 自动处理各种代理格式

### 3. User-Agent伪装

增加了User-Agent轮换功能：

- **内置User-Agent库**：
  - 包含常见浏览器和设备的User-Agent
  - 在请求过程中随机选择

- **自定义User-Agent**：
  - 支持上传自定义User-Agent列表文件
  - 从文件中随机选择

### 4. IP地址伪装

添加了IP地址伪装功能：

- **固定IP伪装**：
  - 可以手动设置伪造的IP地址
  - 自动添加到X-Forwarded-For等相关头部

- **随机IP生成**：
  - 可启用自动随机生成IP地址
  - 每次请求使用不同的伪造IP

### 5. 异步高性能模式

将异步高性能模式集成到Web界面：

- **模式切换**：
  - 可直接在界面上切换标准模式和异步模式
  - 动态调整相关参数的可用性

- **并发控制**：
  - 标准模式：调整线程数（最高100）
  - 异步模式：调整并发连接数（最高5000）

- **速率限制**：
  - 可设置每秒请求数上限
  - 更好地控制压测强度

## 技术实现细节

### 前端实现

1. **动态表单控制**：
   - 根据选项状态动态显示/隐藏相关设置
   - 使用jQuery事件处理各种交互逻辑

2. **标签页导航**：
   - 使用Bootstrap标签页组件
   - 自定义CSS样式优化标签页外观

3. **表单验证**：
   - 客户端验证参数有效性
   - 服务器端二次验证

### 后端实现

1. **表单处理**：
   - 扩展了`BruteforceForm`类，添加新的字段
   - 新增字段的验证规则

2. **文件处理**：
   - 代理列表文件的上传和解析
   - User-Agent文件的上传和解析

3. **异步模式集成**：
   - 根据用户选择切换处理模式
   - 将标准模式和异步模式处理逻辑分开实现

4. **代理功能实现**：
   - 标准模式：记录使用代理（但实际功能有限）
   - 异步模式：完全支持代理池轮换

5. **IP伪装实现**：
   - 添加相关HTTP头
   - 支持固定IP和随机IP生成

## 使用指南

### 基本使用流程

1. 访问Web界面（默认地址：http://127.0.0.1:5000）
2. 在"基本配置"标签页设置目标URL、请求方法等基本参数
3. 在"IP伪装"标签页配置代理、User-Agent和IP伪装设置
4. 在"高级设置"标签页选择异步模式并设置性能参数
5. 点击"开始爆破"按钮启动任务
6. 实时查看任务进度和结果
7. 任务完成后可下载结果文件

### IP伪装配置示例

1. **使用代理服务器**：
   - 勾选"启用代理服务器"
   - 选择"单个代理"或"代理文件"模式
   - 单个代理模式：输入代理地址和选择代理类型
   - 代理文件模式：上传含有多个代理的文本文件

2. **使用User-Agent轮换**：
   - 勾选"随机轮换User-Agent"
   - 选择"使用内置User-Agent库"或"自定义User-Agent文件"
   - 如选择自定义文件，上传含有User-Agent列表的文本文件

3. **伪造源IP**：
   - 勾选"伪造源IP地址"
   - 输入固定IP地址，或勾选"随机生成IP"

### 高级设置示例

1. **使用异步高性能模式**：
   - 勾选"使用异步高性能模式"
   - 设置并发连接数（推荐100-1000）
   - 可选设置速率限制，控制每秒请求数

2. **调整标准模式**：
   - 不勾选"使用异步高性能模式"
   - 设置并发线程数（1-100）
   - 设置请求延迟（秒）

## 注意事项

1. **资源消耗**：异步模式可能会占用更多系统资源，请根据系统配置适当调整并发数
2. **代理质量**：代理服务器的质量会直接影响测试结果，建议使用稳定可靠的代理
3. **合理使用**：请在授权范围内合理使用IP伪装功能，避免违规操作
4. **文件格式**：
   - 代理文件格式参考`sample_proxies.txt`
   - User-Agent文件格式参考`sample_user_agents.txt`

---

通过这些增强功能，Web界面现在可以完全支持所有命令行工具提供的高级功能，使其成为项目的主要使用途径。 